<br>
<!-- SECCION PARA MOSTRAR LAS PARCELAS DISPONIBLES -->
<div class="container">
  <?php if (!empty($reservaciones)): ?>
    <h4> El numero de parcelas encontradas en total bajo esas caracteristicas son: <?= htmlspecialchars(count($reservaciones)) ?></h3>
    <div class="sectores_parcelas">
      <p class="motorhome">Sector Motorhome: <?= htmlspecialchars($parcelas_por_sector['Motorhome']) ?></p>
      <p class="familiar">Sector Familiar: <?= htmlspecialchars($parcelas_por_sector['Familiar']) ?></p>
      <p class="juvenil">Sector juvenil: <?= htmlspecialchars($parcelas_por_sector['Joven']) ?></p>
      <p class="campamento_familiar">Sector campamento familiar: <?= htmlspecialchars($parcelas_por_sector['Carpa Fam']) ?></p>
</div>

    <br>
    <h4>Lista de parcelas encontradas con mas detalle:</h4>
    <br>
    <?php foreach ($reservaciones as $parcela): ?>
      <div class="alert alert-success">
        <img src="<?= htmlspecialchars($parcela['imagen']) ?>
                " alt="Imagen de la parcela">
        <div class="name">
          <p>Descripcion: <?= htmlspecialchars($parcela['descripcion']) ?>
          </p>
        </div>
        <div class="detalles">
          <p>Sector: <?= htmlspecialchars($parcela['sector'])
                      ?></p>
          <p>Uso del espacio: <?= htmlspecialchars($parcela['uso_espacio'])
                              ?></p>
          <p>Sanitarios: <?= htmlspecialchars($parcela['sanitarios_distancia']) ?></p>
          <div><button class="button">Reservar</button></div>
        </div>
      </div> <?php endforeach; ?>
  <?php else: ?> <p class="alert alert-danger">No se encontraron parcelas disponibles.</p>
  <?php endif; ?>
</div>
<br>
    <div id="calendar"></div>
<script src='https://cdn.jsdelivr.net/npm/fullcalendar/index.global.min.js'></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const calendarEl = document.getElementById('calendar');
    const calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      locale: "es",
      events: [], // Inicialmente vacío; los eventos se agregarán dinámicamente
    });

    // Datos de ejemplo obtenidos desde PHP
    const parcelasPorSector = <?= json_encode($parcelas_por_sector); ?>;
    const fechaInicio = '<?= $fechaInicio ?>'; // Fecha inicio seleccionada por el usuario
    const fechaFin = '<?= $fechaFin ?>'; // Fecha fin seleccionada por el usuario

    // Colores para los sectores
    const sectorColors = {
      'Carpa Fam': 'rgb(68, 68, 150)',
      'Familiar': 'rgb(71, 149, 71)',
      'Joven': 'rgb(215, 162, 63)',
      'Motorhome': 'rgb(100, 57, 100)',
    };

    // Función para generar el rango de fechas
    function getDatesInRange(startDate, endDate) {
      const date = new Date(startDate);
      const dates = [];

      while (date <= new Date(endDate)) {
        dates.push(new Date(date));
        date.setDate(date.getDate() + 1);
      }

      return dates;
    }

    // Obtener todas las fechas en el rango
    const allDates = getDatesInRange(fechaInicio, fechaFin);

    // Agregar eventos al calendario para cada día en el rango
    for (const [sector, parcelas] of Object.entries(parcelasPorSector)) {
      if (parcelas > 0) { // Excluir sectores con valor 0
        allDates.forEach(date => {
          calendar.addEvent({
            start: date,
            end: date,
            //title: sector,
            color: sectorColors[sector] || 'gray', // Color del evento según el sector
            display: 'block',
            extendedProps: {
              sector: sector
            },
          });
        });
      }
    }

    // Personalización de los eventos
    calendar.setOption('eventContent', function(arg) {
      const color = sectorColors[arg.event.extendedProps.sector] || 'gray';
      return {
        html: `<div style="width: 12px; height: 12px; background-color: ${color}; border: 1px solid black; border-radius: 3px; display: block;"></div> <span>${arg.event.title}</span>`,
      };
    });

    calendar.render();
  });
</script>