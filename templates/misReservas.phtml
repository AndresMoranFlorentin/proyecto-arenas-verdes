<?php
require_once './models/ReservaModel.php';

// Obtener ID del usuario logueado
$id_usuario = $_SESSION['id'] ?? null;

// Obtener las reservas del usuario
$reservas = [];
if ($id_usuario) {
    $modelo = new ReservaModel();
    $reservas = $modelo->obtenerReservasDelUsuario($id_usuario); // método definido en tu modelo
}
?>

<!-- Mostrar mensajes de éxito o error -->
<?php if (isset($_SESSION['mensaje_reserva'])): ?>
    <div class="alert alert-<?php echo $_SESSION['mensaje_reserva']['tipo']; ?>">
        <?php echo $_SESSION['mensaje_reserva']['texto']; ?>
    </div>
    <?php unset($_SESSION['mensaje_reserva']); ?>
<?php endif; ?>

<!-- Contenedor principal -->
<div class="contenedor-reservas">
    <h2>Mis Reservas</h2>

    <?php if (!empty($reservas)): ?>
        <?php foreach ($reservas as $reserva): ?>
            <div class="reserva d-flex justify-content-between align-items-center p-2 border rounded mb-2">
                <div class="me-3">
                    <p class="mb-0">
                        Reserva ID: <?php echo $reserva['id']; ?> - 
                        Fecha inicio: <?php echo $reserva['fecha_inicio']; ?> - 
                        Fecha fin: <?php echo $reserva['fecha_fin']; ?>
                    </p>
                </div>
                <form method="POST" action="cancelar_reserva" class="m-0">
                    <input type="hidden" name="id_reserva" value="<?php echo $reserva['id']; ?>">
                    <button type="submit" name="eliminar_reserva" class="btn btn-outline-danger btn-sm" title="Eliminar">
                        <i class="bi bi-trash"></i>
                    </button>
                </form>
            </div>
        <?php endforeach; ?>
    <?php else: ?>
        <p>No hay reservas para este usuario.</p>
    <?php endif; ?>
</div>
